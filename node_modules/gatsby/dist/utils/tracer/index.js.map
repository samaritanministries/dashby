{"version":3,"sources":["../../../src/utils/tracer/index.js"],"names":["slash","require","path","opentracing","tracerProvider","initTracer","tracerFile","tracer","resolvedPath","resolve","create","Tracer","initGlobalTracer","stopTracer","stop","module","exports"],"mappings":";;;;;;AAAA,MAAMA,QAAQC,QAAS,OAAT,CAAd;;AACA,MAAMC,OAAOD,QAAS,MAAT,CAAb;;AACA,MAAME,cAAcF,QAAS,aAAT,CAApB;;AAEA,IAAIG,cAAJ;AAEA;;;;;;;;;;AASA,SAASC,UAAT,CAAoBC,UAApB,EAAgC;AAC9B,MAAIC,MAAJ;;AACA,MAAID,UAAJ,EAAgB;AACd,UAAME,eAAeR,MAAME,KAAKO,OAAL,CAAaH,UAAb,CAAN,CAArB;AACAF,qBAAiBH,QAAQO,YAAR,CAAjB;AACAD,aAASH,eAAeM,MAAf,EAAT;AACD,GAJD,MAIO;AACLH,aAAS,IAAIJ,YAAYQ,MAAhB,EAAT,CADK,CAC6B;AACnC;;AAEDR,cAAYS,gBAAZ,CAA6BL,MAA7B;AAEA,SAAOA,MAAP;AACD;;SAEcM,U;;;;;gDAAf,aAA4B;AAC1B,QAAIT,kBAAkBA,eAAeU,IAArC,EAA2C;AACzC,YAAMV,eAAeU,IAAf,EAAN;AACD;AACF,G;;;;AAEDC,OAAOC,OAAP,GAAiB;AACfX,YADe;AAEfQ;AAFe,CAAjB","sourcesContent":["const slash = require(`slash`)\nconst path = require(`path`)\nconst opentracing = require(`opentracing`)\n\nlet tracerProvider\n\n/**\n * tracerFile should be a js file that exports two functions.\n *\n * `create` - Create and return an open-tracing compatible tracer. See\n * https://github.com/opentracing/opentracing-javascript/blob/master/src/tracer.ts\n *\n * `stop` - Run any tracer cleanup required before the node.js process\n * exits\n */\nfunction initTracer(tracerFile) {\n  let tracer\n  if (tracerFile) {\n    const resolvedPath = slash(path.resolve(tracerFile))\n    tracerProvider = require(resolvedPath)\n    tracer = tracerProvider.create()\n  } else {\n    tracer = new opentracing.Tracer() // Noop\n  }\n\n  opentracing.initGlobalTracer(tracer)\n\n  return tracer\n}\n\nasync function stopTracer() {\n  if (tracerProvider && tracerProvider.stop) {\n    await tracerProvider.stop()\n  }\n}\n\nmodule.exports = {\n  initTracer,\n  stopTracer,\n}\n"],"file":"index.js"}